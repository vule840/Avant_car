function imageChoices_getChoices(){var e=GetSelectedField(),i=jQuery("#field_"+e.id);i.find('[class*="-choice-row"]').each(function(i){var t=jQuery(this),o=t.data("index"),a=e.choices.length&&void 0!==e.choices[o].imageChoices_image?e.choices[o].imageChoices_image:"";t.find(".image-choices-option-image").length||t.find(".field-choice-text").before(imageChoices_markup.choicesAdminRow(o,a));var s=t.find(".image-choices-option-image");""!==s.val()&&t.addClass("image-choices-has-image")}),imageChoices_updateFieldPreview(e)}function imageChoices_RemovePreview(e){if("undefined"!=typeof e){var i=jQuery(e).closest('[class*="-choice-row"]');i.find(".image-choices-option-image").val(""),i.find(".image-choices-option-preview").css("background-image",""),i.removeClass("image-choices-has-image"),imageChoices_UpdateFieldChoicesObject();var t=GetSelectedField();imageChoices_updateFieldPreview(t)}}function imageChoices_UpdateFieldChoicesObject(){var e=GetSelectedField(),i=imageChoices_getField(),t="quiz"===e.type?".gquiz-choice-row":'[class*="-choice-row"]';i.find(t).each(function(i){var t=jQuery(this),o=t.find(".image-choices-option-image").val(),a=t.data("index");""!==o?(t.addClass("image-choices-has-image"),t.find(".gf-image-choices-option-preview").css("background-image","url("+o+")")):t.removeClass("image-choices-has-image"),e.choices[a].imageChoices_image=o})}function imageChoices_updateFieldPreview(e){var i=jQuery("#field_"+e.id);e.imageChoices_enableImages&&void 0===e.imageChoices_showLabels&&imageChoices_toggleShowLabels(!0),i.find(".ginput_container .gfield_radio > li, .ginput_container .gfield_checkbox > li").each(function(i){var t=jQuery(this);t.addClass("image-choices-choice");var o=t.find("label"),a=o.find(".image-choices-choice-text").length?o.find(".image-choices-choice-text").html():o.html();if(e.imageChoices_enableImages){var s=void 0!==e.choices[i].imageChoices_image?e.choices[i].imageChoices_image:"";o.html(imageChoices_markup.choicesPreviewRow(i,a,s))}else o.html(a)})}function imageChoices_getField(){var e=GetSelectedField(),i=jQuery("#field_"+e.id);return i}function imageChoices_removeAllChoices(e){var i=e.closest("#field_settings");i.find(".image-choices-option-image-remove").each(function(){jQuery(this).trigger("click")}),i.find(".gf_delete_field_choice").each(function(){jQuery(this).trigger("click")}),i.find('.field-choice-row input[type="text"], .gquiz-choice-row input[type="text"]').val("")}function imageChoices_toggleEnableImages(e){var i=imageChoices_getField(),t=i.find("input.field_choice_images_enabled");void 0===e&&(e=t.is(":checked")),SetFieldProperty("imageChoices_enableImages",e),t.prop("checked",e);var o=jQuery('[id*="gfield_settings_choices_container"]');o.toggleClass("image-choices-enabled",e);var i=o.closest(".gfield");i.toggleClass("image-choices-use-images",e),i.toggleClass("image-choices-admin-field",e);var a=i.find("#gfield_settings_choices_container + input"),s=i.find("#gquiz_gfield_settings_choices_container + input"),c=i.find(".image-choices-remove-choices-btn");c.length||(s.length&&s.after(imageChoices_markup.removeChoicesButton()),a.length&&a.after(imageChoices_markup.removeChoicesButton())),e||(i.removeClass("image-choices-layout-horizontal image-choices-layout-vertical"),c.length&&c.remove());var n,l=jQuery(".field_setting.other_choice_setting");l.length&&(n=l.find("input"),e?(l.hide(),n.length&&n.is(":checked")&&n.trigger("click")):l.show());var g=GetSelectedField();imageChoices_updateFieldPreview(g)}function imageChoices_toggleShowLabels(e){var i=imageChoices_getField(),t=i.find("input.image_choices_show_labels");void 0===e&&(e=t.is(":checked")),SetFieldProperty("imageChoices_showLabels",e),t.prop("checked",e),i.toggleClass("image-choices-show-labels",e)}function imageChoices_updateEntrySetting(e){SetFieldProperty("imageChoices_entrySetting",e)}function imageChoices_updateLayoutSetting(e){SetFieldProperty("imageChoices_choicesLayout",e);var i=GetSelectedField(),t=jQuery("#field_"+i.id);t.removeClass("image-choices-layout-horizontal image-choices-layout-vertical"),t.addClass("image-choices-layout-"+e)}function imageChoices_OpenMediaLibrary(e){if("undefined"!=typeof e){var i=jQuery(e).closest('[class*="-choice-row"]'),t=i.data("file-frame");if(t)return void t.open();t=wp.media({title:"Select an image to upload",button:{text:"Use this image"},frame:"post",state:"insert",multiple:!1}),setTimeout(function(){jQuery('input[value="Insert into Post"]').val("Use this Image"),jQuery("button.media-button-insert").text("Use this Image")},100),jQuery("body").on("click","li.attachment",function(){jQuery('input[value="Insert into Post"]').val("Use this Image"),jQuery("button.media-button-insert").text("Use this Image")}),t.on("insert",function(e){var o=t.state();if(e=e||o.get("selection")){var a=e.first(),s=o.display(a).toJSON();a=a.toJSON();var c=a.sizes[s.size].url;i.find(".image-choices-option-image").val(c),i.find(".image-choices-option-preview").css("background-image","url("+c+")"),i.addClass("image-choices-has-image"),imageChoices_UpdateFieldChoicesObject();var n=GetSelectedField();imageChoices_updateFieldPreview(n)}}),t.open(),i.data("file-frame",t)}}var imageChoices_markup=function(){return{removeChoicesButton:function(){return'<button class="button image-choices-remove-choices-btn" type="button" onclick="imageChoices_removeAllChoices(jQuery(this));">'+imageChoicesFieldStrings.removeAllChoices+"</button>"},enableImagesToggle:function(e,i){var t=e===!0?' checked="checked"':"";return['<div class="image-choices-toggle-wrap">','<label><input type="checkbox" '+t+' id="field_'+i+'_choice_images_enabled" class="field_choice_images_enabled" onclick="imageChoices_toggleEnableImages(this.checked);" onkeypress="imageChoices_toggleEnableImages(this.checked);"> use images</label>',"</div>"].join("")},choicesAdminRow:function(e,i){var t=void 0!==e?e:0,o=void 0!==i?i:"";return['<input type="button" id="image-choices-option-upload-button-'+t+'" class="button image-choices-option-upload-button" value="'+imageChoicesFieldStrings.uploadImage+'" onclick="imageChoices_OpenMediaLibrary(this);" />','<span id="image-choices-option-preview-'+t+'" class="image-choices-option-preview-wrap">','<span class="image-choices-option-preview" style="background-image:url('+o+');"></span>','<a href="javascript:void(0);" class="image-choices-option-image-remove" onclick="imageChoices_RemovePreview(this);" title="'+imageChoicesFieldStrings.removeImage+'"><i class="dashicons dashicons-no"></i></a>',"</span>",'<input type="hidden" id="image-choices-option-image-'+t+'" class="image-choices-option-image" value="'+o+'" />'].join("")},entryValueSelect:function(e,i){var t=void 0!==e?e:"form_setting",o="";form.hasOwnProperty("gf-image-choices")&&form["gf-image-choices"].hasOwnProperty("gf_image_choices_entry_value")&&(o=form["gf-image-choices"].gf_image_choices_entry_value);var a="";"value"==o?a=" ("+imageChoicesFieldStrings.entrySettingValue+")":"image"==o?a=" ("+imageChoicesFieldStrings.entrySettingImage+")":"text"==o?a=" ("+imageChoicesFieldStrings.entrySettingText+")":"image_text"==o?a=" ("+imageChoicesFieldStrings.entrySettingImageText+")":"image_value"==o&&(a=" ("+imageChoicesFieldStrings.entrySettingImageValue+")");var s="form_setting"===t?' selected="selected"':"",c="value"===t?' selected="selected"':"",n="image"===t?' selected="selected"':"",l="text"===t?' selected="selected"':"",g="image_text"===t?' selected="selected"':"",h="image_value"===t?' selected="selected"':"";return['<li class="image-choices-setting-entry-value field_setting">','<label class="section_label">'+imageChoicesFieldStrings.entrySettingTitle+"</label>",'<select id="image-choices-entry-value-'+i+'" class="image-choices-entry-value" onchange="imageChoices_updateEntrySetting(this.value);">','<option value="form_setting"'+s+">"+imageChoicesFieldStrings.entrySettingForm+a+"</option>",'<option value="value"'+c+">"+imageChoicesFieldStrings.entrySettingValue+"</option>",'<option value="image"'+n+">"+imageChoicesFieldStrings.entrySettingImage+"</option>",'<option value="text"'+l+">"+imageChoicesFieldStrings.entrySettingText+"</option>",'<option value="image_text"'+g+">"+imageChoicesFieldStrings.entrySettingImageText+"</option>",'<option value="image_value"'+h+">"+imageChoicesFieldStrings.entrySettingImageValue+"</option>","</select>","</li>"].join("")},showLabelsToggle:function(e,i){var t=e===!0?' checked="checked"':"";return['<li class="image-choices-setting-title field_setting">','<label class="section_label">'+imageChoicesFieldStrings.displaySettingsTitle+"</label>","</li>",'<li class="image-choices-setting-show-labels field_setting">','<label><input id="image_choices_show_labels_'+i+'" class="image_choices_show_labels" type="checkbox" '+t+' onclick="imageChoices_toggleShowLabels(this.checked);" onkeypress="imageChoices_toggleShowLabels(this.checked);"> '+imageChoicesFieldStrings.showLabels+"</label>","<p><small>"+imageChoicesFieldStrings.showLabelsDescription+"</small></p>","</li>"].join("")},choicesLayoutSelect:function(e,i){var t=void 0!==e?e:"horizontal",o="horizontal"===t?' selected="selected"':"",a="vertical"===t?' selected="selected"':"";return['<li class="image-choices-setting-layout field_setting">','<label class="gfield_value_label" for="image-choices-layout-'+i+'">'+imageChoicesFieldStrings.selectLayout+"</label>",'<select id="image-choices-layout-'+i+'" class="image-choices-layout" onchange="imageChoices_updateLayoutSetting(this.value);">','<option value="horizontal"'+o+">"+imageChoicesFieldStrings.layoutHorizontal+"</option>",'<option value="vertical"'+a+">"+imageChoicesFieldStrings.layoutVertical+"</option>","</select>","</li>"].join("")},choicesPreviewRow:function(e,i,t){var o=void 0!==i?i:"",a=void 0!==t?t:"";return['<span class="image-choices-choice-image-wrap" style="background-image:url('+a+')">','<img src="'+a+'" alt="'+o+'" class="image-choices-choice-image" />',"</span>",'<span class="image-choices-choice-text">'+o+"</span>"].join("")}}}(),GF_UpdateFieldChoices;jQuery(document).bind("gform_load_field_settings",function(e,i,t){if("function"!=typeof GF_UpdateFieldChoices&&(GF_UpdateFieldChoices=UpdateFieldChoices,window.UpdateFieldChoices=function(){GF_UpdateFieldChoices.apply(this,arguments),setTimeout(function(){imageChoices_getChoices()},10)}),"radio"===i.type||"checkbox"===i.type||"quiz"===i.type&&"radio"==i.inputType||"quiz"===i.type&&"checkbox"==i.inputType||"poll"===i.type&&"radio"==i.inputType||"poll"===i.type&&"checkbox"==i.inputType||"post_custom_field"===i.type&&"radio"==i.inputType||"post_custom_field"===i.type&&"checkbox"==i.inputType||"survey"===i.type&&"radio"==i.inputType||"survey"===i.type&&"checkbox"==i.inputType||"product"===i.type&&"radio"==i.inputType||"option"===i.type&&"radio"==i.inputType||"option"===i.type&&"checkbox"==i.inputType)!function(e){setTimeout(function(){var i=jQuery("#field_"+e.id+" #field_settings");jQuery("#field_"+e.id).addClass("image-choices-admin-field");var t=e.imageChoices_enableImages===!0;i.find("input.field_choice_images_enabled").length||i.find('[id*="gfield_settings_choices_container"]').prepend(imageChoices_markup.enableImagesToggle(t)),imageChoices_toggleEnableImages(t);var o=void 0===e.imageChoices_showLabels||e.imageChoices_showLabels;i.find("input.image_choices_show_labels").length||i.find(".css_class_setting").after(imageChoices_markup.showLabelsToggle(o)),imageChoices_toggleShowLabels(o);var a=void 0!==e.imageChoices_entrySetting?e.imageChoices_entrySetting:"form_setting";if(i.find(".image-choices-entry-value").length){var s=i.find(".image-choices-entry-value");s.val(a),s.find("option[selected]").length&&s.find("option[selected]").removeAttr("selected"),s.find('option[value="'+a+'"]').prop("selected",!0),i.find(".image-choices-setting-entry-value").show()}else i.find(".image-choices-setting-show-labels").after(imageChoices_markup.entryValueSelect(a));imageChoices_updateEntrySetting(a),i.find('[class*="-choice-row"]').each(function(i){var t=jQuery(this),o=t.data("index"),a=e.choices.length&&void 0!==e.choices[o].imageChoices_image?e.choices[o].imageChoices_image:"";t.find(".image-choices-option-image").length||t.find(".field-choice-text").before(imageChoices_markup.choicesAdminRow(o,a));var s=t.find(".image-choices-option-image");""!==s.val()&&t.addClass("image-choices-has-image")}),imageChoices_updateFieldPreview(e)},10)}(i);else{var o=jQuery("#field_"+field.id+" #field_settings");o.find(".image-choices-toggle-wrap").length&&(o.find(".image-choices-toggle-wrap").remove(),imageChoices_toggleEnableImages(!1)),o.find(".image-choices-setting-show-labels").length&&(o.find(".image-choices-setting-show-labels").remove(),imageChoices_toggleShowLabels(!1))}}),jQuery(document).ready(function(){jQuery(".gfield.image-choices-admin-field").each(function(){var e=jQuery(this);e.find(".ginput_container .gfield_radio > li, .ginput_container .gfield_checkbox > li").each(function(e){var i=jQuery(this);i.addClass("image-choices-choice")})});var e,i=jQuery("#gf_image_choices_custom_css_global");i.length&&(i.after('<div id="gf_image_choices_custom_css_global_editor">'+i.text()+"</div>"),e=ace.edit("gf_image_choices_custom_css_global_editor"),e.setOptions({showInvisibles:!1,showGutter:!0,showLineNumbers:!0,displayIndentGuides:!1,scrollPastEnd:!1,theme:"ace/theme/xcode"}),e.session.setMode("ace/mode/css"),e.getSession().on("change",function(){i.val(e.getSession().getValue())}));var t=jQuery("#gf_image_choices_custom_css");t.length&&(t.after('<div id="gf_image_choices_custom_css_editor">'+t.text()+"</div>"),e=ace.edit("gf_image_choices_custom_css_editor"),e.setOptions({showInvisibles:!1,showGutter:!0,showLineNumbers:!0,showFoldWidgets:!1,displayIndentGuides:!1,scrollPastEnd:!1,theme:"ace/theme/xcode"}),e.session.setMode("ace/mode/css"),e.getSession().on("change",function(){t.val(e.getSession().getValue())}))});